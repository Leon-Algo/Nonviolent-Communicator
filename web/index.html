<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NVC Practice Web</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&family=Noto+Sans+SC:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div class="bg-grid"></div>
    <main class="container">
      <header class="hero">
        <p class="eyebrow">NVC MVP Playground</p>
        <h1>非暴力沟通<br />在线练习台</h1>
        <p class="sub">
          前端仅用于 MVP 联调：创建场景、发起会话、发送练习消息并查看 OFNR 反馈。
        </p>
      </header>

      <section class="card">
        <h2>连接配置</h2>
        <div class="grid two">
          <label>
            API Base URL
            <input id="apiBaseUrl" type="text" value="" placeholder="默认同域代理，不填即可" />
          </label>
          <label>
            鉴权模式
            <select id="authMode">
              <option value="mock">Mock</option>
              <option value="supabase">Supabase JWT</option>
            </select>
          </label>
        </div>
        <div class="grid two">
          <label>
            Mock User UUID
            <input id="mockUserId" type="text" />
          </label>
          <label>
            Supabase URL
            <input id="supabaseUrl" type="text" placeholder="https://<project-ref>.supabase.co" />
          </label>
        </div>
        <div class="grid two">
          <label>
            Supabase Anon Key
            <input id="supabaseAnonKey" type="text" placeholder="sb_publishable_..." />
          </label>
          <label>
            Supabase Email
            <input id="supabaseEmail" type="email" placeholder="test@example.com" />
          </label>
        </div>
        <div class="grid two">
          <label>
            Supabase Password
            <input id="supabasePassword" type="password" placeholder="your password" />
          </label>
          <label>
            Access Token
            <input id="supabaseAccessToken" type="text" placeholder="登录后自动填充，或手动粘贴" />
          </label>
        </div>
        <div class="actions">
          <button id="newUserBtn" type="button">生成新用户</button>
          <button id="supabaseLoginBtn" type="button">Supabase 登录取 Token</button>
          <button id="clearTokenBtn" type="button" class="secondary">清空 Token</button>
          <button id="useProxyBtn" type="button">切换同域代理</button>
          <button id="saveConfigBtn" type="button" class="secondary">保存配置</button>
        </div>
      </section>

      <section class="card">
        <h2>1) 创建场景</h2>
        <div class="grid two">
          <label>
            标题
            <input id="sceneTitle" type="text" value="和同事沟通延期风险" />
          </label>
          <label>
            沟通目标
            <input id="sceneGoal" type="text" value="确认新的里程碑并明确责任" />
          </label>
        </div>
        <label>
          场景背景
          <textarea id="sceneContext" rows="3">这个需求已经两次延期，影响发布节奏</textarea>
        </label>
        <div class="actions">
          <button id="createSceneBtn" type="button">创建场景</button>
        </div>
        <p class="meta">scene_id: <code id="sceneIdValue">-</code></p>
      </section>

      <section class="card">
        <h2>2) 创建会话</h2>
        <div class="grid two">
          <label>
            目标轮数
            <input id="targetTurns" type="number" min="5" max="8" value="6" />
          </label>
          <label>
            当前 session_id
            <input id="sessionIdInput" type="text" placeholder="自动填充或手动输入" />
          </label>
        </div>
        <div class="actions">
          <button id="createSessionBtn" type="button">创建会话</button>
        </div>
      </section>

      <section class="card">
        <h2>3) 发送练习消息</h2>
        <label>
          用户发言
          <textarea id="messageContent" rows="3">你们总是拖延，根本不专业。</textarea>
        </label>
        <div class="actions">
          <button id="sendMessageBtn" type="button">发送消息并获取反馈</button>
        </div>
      </section>

      <section class="card">
        <h2>响应面板</h2>
        <pre id="output">{}</pre>
      </section>
    </main>

    <script src="./app.js"></script>
  </body>
</html>
